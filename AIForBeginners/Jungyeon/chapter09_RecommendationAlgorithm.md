## 제9장 추천 알고리즘: 알 수 없는 유튜브 알고리즘이 여기로 이끌다

#### 추천 서비스, 넷플릭스에서 유튜브까지
- 2006년 **넷플릭스**, 스트리밍 서비스 시작 전부터 고객에게 영화를 잘 추천해주기 위해 넷플릭스 프라이즈 개최
    - 고객이 영화에 부여한 별점 데이터 1억 건을 공개하고 고객이 보지 않은 영화에 부여할 별점을 예측하는 대회. 기존보다 10% 향상된 알고리즘을 제출하는 팀에게 100만 달러 상금 지급
    - 2009년 경쟁하던 3팀이 단일팀(Bellkor's Pragmatic Chaos)으로 뭉쳐 대회에서 우승
- 이후 넷플릭스는 지속적으로 추천 알고리즘에 투자해왔으며 현재 넷플릭스의 시청 80%가 추천을 통해 이루어짐

- **스포티파이** 서비스 전체가 추천으로 구성되었으며 BaRT(Bandits for Recommendation as Treatments)라는 추천 알고리즘 사용
    - 고객 정보를 바탕으로 플레이리스트를 자동으로 생성해주는 기능은 스포티파이의 핵심 기능

- **페이스북** 2007년 좋아요 버튼 등장. 2009년 좋아요를 많이 받은 게시물이 피드 위로 가는 알고리즘 개발
    - 이 알고리즘을 고도화해서 현재는 누가 게시했는지, 게시자의 영향력, 평소의 인터렉션 등을 여러 요소를 계산해서 노출 여부 결정
        - 개인화도 적용해서 만약에 댓글보다 좋아요를 많이 누르는 사람이라면 좋아요에 더 가중치를 두고, 인터넷 속도가 느리다면 동영상을 적게 보여줌

- 추천 시스템의 원조는 **아마존**
    - 1990년대부터 구매한 상품과 관련 있는 상품, 고객이 관심 있어 할 만환 제품을 추천
    - 아마존의 추천 시스템을 다룬 2003년 논문, 지난 20년간 가장 영향력 있는 논문으로 선정
- 추천 서비스의 핵심은 사용하면 할수록 정교해진다는 것. 데이터가 늘어나고 정보가 많아질수록 훨씬 정확한 추천 가능
- 상품 간의 상관관계를 찾아내기 위해 아마존이 가장 먼저 적용한 분석 방식은 연관성 분석
    - `연관성 분석(Association Analysis)` : 데이터 내의 여러 항목이 함께 발생하는 경향을 분석하여, 이들 항목 간의 숨겨진 규칙을 찾아내는 기법


#### 맥주와 기저귀는 함께 팔린다
- `장바구니 분석(Market Basket Analysis)` : 고객의 구매 내역을 보고 상품 간의 연관성을 분석하는 방식
    - 1993년 IBM에서 근무하던 라케시 아그라왈(Rakesh Agrawal)박사가 처음 시도해 논문 게재
- `데이터 마이닝(Data Mining)` : 대규모 데이터에서 어떤 특정한 패턴을 발견하고 추출하는 행위

- 연관성 분석에는 `신뢰도(Confidence)`라는 지표 활용. 신뢰도가 높을 수록 연관성이 높은 상품
    - 단 원래 자주 팔리는 상품이라면 타 상품과 자주 같이 구매될 가능성이 높으므로 연광성을 정확하게 판단하기 어려움
    - 따라서 판매 빈도까지 고려하는 지표인 `향상도(Lift)` 활용. 향상도가 1보다 크면 함께 팔릴 가능성이 높고 1보다 작으면 함께 팔릴 가능성이 작다고 판단


#### 추천 시스템의 시작
- 유튜브나 영화 등 영상의 기본적인 추천 시스템 2가지
    - `콘텐츠 기반 필터링(Content-based Filtering)` : 내가 선호하는 영화와 비슷한 영화를 추천하는 방식
        - 영화 간 코사인 거리가 가장 가까운 영화를 비슷한 영화로 인지하고 추천
        - 타 고객의 데이터는 필요 없고 고객 선호도에 대한 특징만 있음 가능
        - 단, 한계점 존재
            - 영화의 특징을 규정 짓기 어려움. 특징의 분류는 계속 생겨날 수 있고 사람이 분류해야 된다는 어려움
            - 특징을 세분화해도 고객의 관심사를 확장하기엔 어려움
    - `협업 필터링(Collaborative Filtering)` : 나와 비슷한 고객이 시청한 영화를 추천하는 방식
        - 콘텐츠 기반 필터링의 한계를 보완하기 위해 영화 자체의 특징에 집중하기 보다 범위를 확장해서 유사한 고객의 정보 활용해서 관심사 확장 가능
        - 핵심은 고객 간의 유사도. 유사도가 큰 고객들을 연결해 관심 있을만한 영화를 추천하는 것


#### 행렬 인수분해, 잠재요인을 찾아내는 마법의 알고리즘
- `행렬 인수분해(Matrix Factorization)` : 협업 필터링이 확장된 기법. 제각각인 평점 정보를 이용해 고객의 특징을 자동으로 추출하고 영화 특징도 자동으로 추출해서 고객의 평점 예측
- 사이먼 펑크(Simon Funk)라는 가명을 쓴 사람이 알고리즘 개발
- 핵심 원리 : 고객의 영화 평점을 하나의 행렬로 보고 이를 2개의 다른 행렬로 분해해서 자동으로 예측 정보를 얻음
    예시 : 
    1) 이 영화는 액션이 얼마나 있나요?
    2) 이 고객은 액션 영화를 얼마나 좋아하나요?
    3) 1-2번을 질문한 후 결과를 합산해서 판단
    (고객 행렬과 영화 행렬의 전치 행렬을 구한 다음 서로 내적을 구함)
- 행렬 인수분해는 숨어 있는 특징을 자동으로 추출하는데 이를 `잠재요인(Latent Factors)` 발굴이라고 표현
    - 실제로는 최소 25가지의 잠재요인을 발굴해내며 컴퓨터가 자동으로 작업함(K라고 표현하며 값은 차원(dimension)의 개수)
        - Why 25? 사이먼 펑크가 설정한 값. 관례적으로 쓰임. 현업에서는 다양한 값을 실험해 보고 가장 좋은 성능을 내는 값 채택
    - 계산을 위해 평점 정보가 필요하며 유사한 평점을 받은 영화 데이터를 학습하다 보면 비슷한 장르끼리 비슷한 점수를 받는 경우를 자동으로 발견해냄
    - 다만, 특징의 개수를 크게 지정하기 위해서는 많은 양의 데이터가 필요하기 때문에 무작정 특징의 수를 늘릴 수는 없음. 데이터가 부족하면 제대로 특징을 추출하지 못하고 성능이 떨어지기 때문
    - `차원의 저주(Curse of Dimensionality)` : 데이터 학습을 위해 차원이 증가하면서 학습데이터 수가 차원의 수보다 적어져 성능이 저하되는 현상


#### 딥러닝을 도입한 유튜브 추천 알고리즘
- 행렬 인수분해 기법은 결과를 도출하기 위해 내재된 특성을 찾아 여러 차례 계산하는 구조가 마치 인공 신경망을 활용하는 딥러닝과 비슷함
    - 따라서 최근 행렬 인수분해 대신 딥러닝을 활용하려는 시도 활발
- 유튜브도 2016년쯤부터 딥러닝 모델을 도입해서 평정 정보 외에도 고객의 성별, 거주 국가, 시청 기록, 언어 등 다양한 정보를 활용해서 예측하며 심지어 편향을 줄이기 위해 유튜브 밖에서 시청한 영상 이력도 확인
    - 사용자가 시청하는 영상 중 70%는 알고리즘이 추천한 영상
    - 크리에이터들의 영상 품질을 높이기 위해 많이 클릭하는 (어그로성) 콘텐츠가 아니라 '덜 클릭하고 오래보는' 영상에 집중
    - 새로 올라온 영상 또한 중요한데 신규 영상은 영상에 대한 아무런 정보가 없기 때문에 `콜드 스타트(Cold Start)` 문제에 봉착
    - 고객이 기존 취향의 울타리 안에 갇히는 문제인 `필터 버블(Filter Bubble)`도 존재
        - 팔터 버블은 사람의 편견을 강화해서 더욱 단절된 사회를 만들고 위험한 문제로 번질 수 있음


> #### ***comments***
> - 생각보다 추천 시스템의 역사가 오래된 것에 놀랐다. 그리고 추천 시스템이나 알고리즘이 활성화된 서비스는 모두 현재까지 흥행한다는 점에서 결국 고객 개개인을 잘 파악하고 니즈를 맞춰주는게 사업을 존속하는데 얼마나 중요한지 보여주는 사례라고 생각됨
> - 유튜브 알고리즘이 많은 요소를 고려해서 만들어졌을거라고 생각했지만 유튜브 사이트 외에서 시청하는 영상까지 확인한다는 점이 신기했다. 근데 그 이력은 어디까지 확인이 되지? (확인한다는 정보치고 개인적으로는 유튜브 알고리즘이 대단히 추천을 잘하는 것 같다는 느낌을 받지 못했다. 내가 워낙 다양한 콘텐츠를 봐서 그런가..?)
> - 사이먼 펑크 모야...? 누구야...?
> - 좋아요를 10번 누르면 알고리즘은 직장 동료보다 정확하게 사용자의 성격을 예측할 수 있고 70번을 누르면 친구나 룸메이트보다 정확해진다는 연구 결과가 있던데 공감되면서도 인간은 자원을 많이 들여 파악하는 다른 사람들의 취향을 알고리즘이 단시간에 빠르고 정확하게 판단할 수 있다는게 조금 무섭게 느껴짐


> #### ***food for thought***
> - 친한 친구보다도 사용자를 잘 파악해서 개인화된 컨텐츠를 추천해준다는 점에서 추천 알고리즘은 편리하지만 필터 버블에 갇힐 수도 있다는 점이 무섭기도 하다. 필터 버블에 있다는 것을 개인이 어떻게 파악할 수 있을까? 그리고 방지하기 위해서는 어떻게 해야 할까?